[2023-12-06 21:18:25,876] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: ETL_redshift_docker_airflow.extraer_data manual__2023-12-06T21:18:23.839899+00:00 [queued]>
[2023-12-06 21:18:25,886] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: ETL_redshift_docker_airflow.extraer_data manual__2023-12-06T21:18:23.839899+00:00 [queued]>
[2023-12-06 21:18:25,886] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2023-12-06 21:18:25,887] {taskinstance.py:1377} INFO - Starting attempt 1 of 6
[2023-12-06 21:18:25,888] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2023-12-06 21:18:25,902] {taskinstance.py:1397} INFO - Executing <Task(PythonOperator): extraer_data> on 2023-12-06 21:18:23.839899+00:00
[2023-12-06 21:18:25,909] {standard_task_runner.py:52} INFO - Started process 214 to run task
[2023-12-06 21:18:25,912] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'ETL_redshift_docker_***', 'extraer_data', 'manual__2023-12-06T21:18:23.839899+00:00', '--job-id', '98', '--raw', '--subdir', 'DAGS_FOLDER/ETL a Redshift.py', '--cfg-path', '/tmp/tmp0hpi4r9r', '--error-file', '/tmp/tmplt_4iv5l']
[2023-12-06 21:18:25,914] {standard_task_runner.py:80} INFO - Job 98: Subtask extraer_data
[2023-12-06 21:18:25,970] {task_command.py:371} INFO - Running <TaskInstance: ETL_redshift_docker_airflow.extraer_data manual__2023-12-06T21:18:23.839899+00:00 [running]> on host 4357a10b93bd
[2023-12-06 21:18:26,007] {logging_mixin.py:115} WARNING - /home/***/.local/lib/python3.7/site-packages/***/utils/context.py:202 AirflowContextDeprecationWarning: Accessing 'execution_date' from the template is deprecated and will be removed in a future version. Please use 'data_interval_start' or 'logical_date' instead.
[2023-12-06 21:18:26,041] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=ManuelMoyano
AIRFLOW_CTX_DAG_ID=ETL_redshift_docker_***
AIRFLOW_CTX_TASK_ID=extraer_data
AIRFLOW_CTX_EXECUTION_DATE=2023-12-06T21:18:23.839899+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2023-12-06T21:18:23.839899+00:00
[2023-12-06 21:18:26,042] {logging_mixin.py:115} INFO - Adquiriendo data para la fecha: 2023-12-06 21
[2023-12-06 21:18:33,366] {python.py:173} INFO - Done. Returned value was: {'df_movie_1':          id                                  title  ... vote_average vote_count
0    466420             Killers of the Flower Moon  ...        7.700       1089
1    787699                                  Wonka  ...        6.938          8
2    872585                            Oppenheimer  ...        8.146       5203
3    956920          There's Something in the Barn  ...        7.615         13
4   1022964                        Candy Cane Lane  ...        6.448         87
5    335977  Indiana Jones and the Dial of Destiny  ...        6.677       2162
6    798021                          Family Switch  ...        6.358        173
7    839369                           May December  ...        6.600         52
8    781732                                 Animal  ...        6.500         12
9   1202584                     Christmas As Usual  ...        5.800          6
10   940721                     Godzilla Minus One  ...        8.462         52
11   753342                               Napoleon  ...        6.440        568
12   346698                                 Barbie  ...        7.183       6149
13  1116488                           The Shepherd  ...        6.800         28
14   901362                   Trolls Band Together  ...        7.191        280
15   840430                          The Holdovers  ...        7.800         87
16  1075794                                    Leo  ...        7.495        425
17   823464        Godzilla x Kong: The New Empire  ...        0.000          0
18   507089                Five Nights at Freddy's  ...        7.838       2674
19   897087                              Freelance  ...        6.436        140

[20 rows x 10 columns], 'df_tv_1':         id                        original_name  ... vote_average vote_count
0    57243                           Doctor Who  ...        7.460       2710
1    96648                                 스위트홈  ...        8.398       1121
2   239770                           Doctor Who  ...        7.800         34
3   216985                         Pax Massilia  ...        8.000          3
4    37854                                ワンピース  ...        8.728       4196
5     1429                                進撃の巨人  ...        8.667       5738
6    94244                          Obliterated  ...        6.500         24
7   202411          Monarch: Legacy of Monsters  ...        8.219        251
8   230131                                 南海归墟  ...        9.250          4
9   215474                             사운드트랙 #2  ...        5.000          1
10   60622                                Fargo  ...        8.303       2343
11  134095     A Murder at the End of the World  ...        7.818         33
12   95480                          Slow Horses  ...        7.767        253
13    1399                      Game of Thrones  ...        8.442      22226
14  238126  John Lennon: Murder Without a Trial  ...        0.000          1
15   95479                                 呪術廻戦  ...        8.565       2949
16  204082            Squid Game: The Challenge  ...        6.189         98
17   84958                                 Loki  ...        8.185      10841
18  229915                             밤이 되었습니다  ...        7.000          3
19   60625                       Rick and Morty  ...        8.701       8862

[20 rows x 10 columns], 'df_movie_2':          id  ... vote_count
0    897087  ...        140
1   1046032  ...         17
2   1022796  ...         87
3    575264  ...       2628
4    670292  ...       1312
5   1058620  ...          6
6    569094  ...       5075
7    926393  ...       1809
8    695721  ...        578
9    609681  ...        605
10  1071215  ...         80
11      771  ...      10309
12   844416  ...         18
13  1027073  ...         35
14   994133  ...          6
15   940551  ...          4
16   986054  ...         69
17   951491  ...       1211
18      597  ...      23914
19   603692  ...       5095

[20 rows x 10 columns], 'df_tv_2':         id         original_name  ... vote_average vote_count
0   155631     The Santa Clauses  ...        7.324        125
1      121            Doctor Who  ...        7.900        527
2    94997   House of the Dragon  ...        8.435       3543
3   204999         Faraway Downs  ...        6.778         18
4    76479              The Boys  ...        8.470       8962
5      456          The Simpsons  ...        7.999       9277
6    85937                  鬼滅の刃  ...        8.682       5740
7   218539                  마이데몬  ...        8.739         23
8   120089            SPY×FAMILY  ...        8.605       1550
9   202208     The Artful Dodger  ...        8.846         13
10  219651               웰컴투 삼달리  ...        7.500          4
11  230225            Black Cake  ...        7.722         18
12   30984                BLEACH  ...        8.398       1641
13  119495          陰の実力者になりたくて！  ...        7.800         67
14   82684         転生したらスライムだった件  ...        8.541        675
15    1396          Breaking Bad  ...        8.896      12720
16   46648        True Detective  ...        8.300       2865
17  105009             東京リベンジャーズ  ...        8.512       1049
18  223438  The Couple Next Door  ...        5.900          7
19  108978               Reacher  ...        8.008        900

[20 rows x 10 columns]}
[2023-12-06 21:18:33,425] {xcom.py:586} ERROR - Could not serialize the XCom value into JSON. If you are using pickle instead of JSON for XCom, then you need to enable pickle support for XCom in your *** config.
[2023-12-06 21:18:33,427] {taskinstance.py:1909} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 68, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 2412, in xcom_push
    session=session,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/utils/session.py", line 68, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/xcom.py", line 198, in set
    map_index=map_index,
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/xcom.py", line 583, in serialize_value
    return json.dumps(value).encode('UTF-8')
  File "/usr/local/lib/python3.7/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/usr/local/lib/python3.7/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/local/lib/python3.7/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/usr/local/lib/python3.7/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type DataFrame is not JSON serializable
[2023-12-06 21:18:33,435] {taskinstance.py:1420} INFO - Marking task as UP_FOR_RETRY. dag_id=ETL_redshift_docker_***, task_id=extraer_data, execution_date=20231206T211823, start_date=20231206T211825, end_date=20231206T211833
[2023-12-06 21:18:33,447] {standard_task_runner.py:97} ERROR - Failed to execute job 98 for task extraer_data (Object of type DataFrame is not JSON serializable; 214)
[2023-12-06 21:18:33,455] {local_task_job.py:156} INFO - Task exited with return code 1
[2023-12-06 21:18:33,484] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
